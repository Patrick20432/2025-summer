## Project6ï¼šGoogle Password Checkup 

æœ¬é¡¹ç›®å®ç°äº† Google Password Checkup è®ºæ–‡ï¼ˆ[ePrint 2019/723](https://eprint.iacr.org/2019/723.pdf)ï¼‰ä¸­ Figure 2 æ‰€æè¿°çš„ **DDH-based Private Intersection-Sum Protocol**ï¼Œå¹¶é€šè¿‡å®éªŒéªŒè¯äº†åè®®çš„æ­£ç¡®æ€§ã€‚

## ğŸ“– å®éªŒåŸç†

è¯¥åè®®ç”¨äºåœ¨ **åŒæ–¹é›†åˆäº¤é›†è®¡ç®—** çš„åŒæ—¶ï¼Œ**å®‰å…¨åœ°å¯¹äº¤é›†å…ƒç´ å…³è”çš„æ•°å€¼è¿›è¡Œæ±‚å’Œ**ï¼Œä¸”ä¸ä¼šæ³„éœ²å„è‡ªé›†åˆä¸­éäº¤é›†å…ƒç´ çš„ä¿¡æ¯ã€‚

æœ¬å®ç°åŸºäºï¼š
- **æ¤­åœ†æ›²çº¿ Diffie-Hellman (ECDH)** ç”¨äºé›†åˆå…ƒç´ åŒ¹é…
- **Paillier åŒæ€åŠ å¯†** ç”¨äºåŠ å¯†å¹¶åŒæ€æ±‚å’Œäº¤é›†å…ƒç´ çš„æ•°å€¼
- **å¯†æ–‡åˆ·æ–°ï¼ˆrerandomizationï¼‰** é˜²æ­¢å¯†æ–‡é“¾æ¥æ”»å‡»

åè®®è¿è¡Œä¸‰è½®ï¼ˆP1: Party 1ï¼ŒP2: Party 2ï¼‰ï¼š
1. **Round 1**  
   - P1 å¯¹é›†åˆä¸­æ¯ä¸ªå…ƒç´  v è¿›è¡Œå“ˆå¸Œæ˜ å°„åˆ°æ›²çº¿ç‚¹ `H(v)`  
   - ç”¨éšæœºæ ‡é‡ k1 æ‰§è¡Œç‚¹ä¹˜ï¼Œå¾—åˆ° `H(v)^k1`ï¼Œå‘é€ç»™ P2
2. **Round 2**  
   - P2 å¯¹æ”¶åˆ°çš„æ¯ä¸ªç‚¹å†ä¹˜ k2ï¼Œå¾—åˆ° `H(v)^(k1Â·k2)`  
   - å¯¹è‡ªå·±çš„é›†åˆ w è®¡ç®— `H(w)^k2`ï¼Œå¹¶ç”¨ Paillier å…¬é’¥åŠ å¯†å…¶å…³è”å€¼ t(w)  Â·
   - å°† `Z = {H(v)^(k1Â·k2)}` å’Œ `{H(w)^k2, Enc(t(w))}` å‘ç»™ P1
3. **Round 3**  
   - P1 å¯¹ `{H(w)^k2}` å†ä¹˜ k1 å¾—åˆ° `H(w)^(k1Â·k2)`  
   - æ¯”å¯¹ Z æ‰¾åˆ°äº¤é›†å…ƒç´ ç´¢å¼•  
   - å¯¹äº¤é›†ä¸­ `Enc(t(w))` åŒæ€æ±‚å’Œå¹¶åˆ·æ–°å¯†æ–‡  
   - å°†æ±‚å’Œå¯†æ–‡å‘ç»™ P2
4. **è§£å¯†**  Â·Â·
   - P2 ç”¨ç§é’¥è§£å¯†å¯†æ–‡ï¼Œå¾—åˆ°äº¤é›†å…ƒç´ å…³è”å€¼çš„æ€»å’Œ

---

## ğŸ“Š åè®®æµç¨‹å›¾

```mermaid
sequenceDiagram
    participant P1 as Party 1 (User Set V)
    participant P2 as Party 2 (Breach DB W, values t)

    Note over P1,P2: å…¬å…±å‚æ•°: æ¤­åœ†æ›²çº¿ç”Ÿæˆå…ƒ G, å…¬å…±å“ˆå¸Œå‡½æ•° H()

    P1->>P1: ç”Ÿæˆéšæœºæ ‡é‡ k1
    P2->>P2: ç”Ÿæˆéšæœºæ ‡é‡ k2, ç”Ÿæˆ Paillier å…¬ç§é’¥å¯¹

    P2-->>P1: å‘é€ Paillier å…¬é’¥ pk

    %% Round 1
    P1->>P1: å¯¹æ¯ä¸ª v âˆˆ V, è®¡ç®— H(v)^k1
    P1-->>P2: å‘é€ {H(v)^k1}

    %% Round 2
    P2->>P2: å¯¹æ”¶åˆ°çš„æ¯ä¸ª H(v)^k1 å†ä¹˜ k2 â†’ å¾—åˆ° H(v)^(k1Â·k2)
    P2->>P2: å¯¹æ¯ä¸ª w âˆˆ W, è®¡ç®— H(w)^k2, å¹¶ç”¨ pk åŠ å¯† t(w)
    P2-->>P1: å‘é€ {H(v)^(k1Â·k2)} (Z), {H(w)^k2, Enc(t(w))}

    %% Round 3
    P1->>P1: å¯¹æ¯ä¸ª H(w)^k2 å†ä¹˜ k1 â†’ H(w)^(k1Â·k2)
    P1->>P1: åŒ¹é… Z é›†åˆæ‰¾äº¤é›†
    P1->>P1: å¯¹äº¤é›†ä¸­ Enc(t(w)) åŒæ€æ±‚å’Œå¹¶åˆ·æ–°å¯†æ–‡
    P1-->>P2: å‘é€ åˆ·æ–°åçš„ Enc(sum)

    P2->>P2: ç”¨ sk è§£å¯† Enc(sum) â†’ å¾—åˆ°äº¤é›†æ€»å’Œ


```


## ğŸ“‚ é¡¹ç›®ç»“æ„


```
â”œâ”€â”€ paillier.py         # çº¯ Python å®ç°çš„ Paillier åŠ å¯†ï¼ˆæ”¯æŒåŒæ€åŠ æ³•å’Œåˆ·æ–°ï¼‰
â”œâ”€â”€ crypto_utils.py     # æ¤­åœ†æ›²çº¿æ“ä½œ + Paillier å°è£…
â”œâ”€â”€ party.py            # Party 1 / Party 2 åè®®å®ç°
â”œâ”€â”€ run_protocol.py     # ä¸»ç¨‹åºï¼Œè¿è¡Œå®éªŒæ¨¡æ‹Ÿ
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜æ–‡ä»¶
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1ï¸âƒ£ å…‹éš†é¡¹ç›®

```
git clone https://github.com/Patrick20432/2025-summer.git
cd Project6
```
### 2ï¸âƒ£ å®‰è£…ä¾èµ–

```
pip install ecdsa
```
> é¡¹ç›®ä½¿ç”¨çº¯ Python å®ç°çš„ Paillierï¼Œå› æ­¤æ— éœ€é¢å¤–åŠ å¯†åº“ã€‚

### 3ï¸âƒ£ è¿è¡Œå®éªŒ

```
python run_protocol.py
```

### 4ï¸âƒ£ é¢„æœŸè¾“å‡º

```
=== DDH Private Intersection-Sum Protocol ===
P1 set size: 8
P2 set size: 7
Expected intersection size: 5

=== Results ===
Intersection size: 5
Computed sum: 242
Expected sum: 242
Protocol succeeded
```

---

## âœ… å®éªŒéªŒè¯

- **äº¤é›†å¤§å°**åŒ¹é… `Expected intersection size`
- **æ±‚å’Œç»“æœ**åŒ¹é… `Expected sum`
- å®ç°å®Œå…¨éµå¾ªè®ºæ–‡ Figure 2 çš„ä¸‰è½®äº¤äº’åè®®
